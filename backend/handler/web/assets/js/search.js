/**
 * Created by zhuangxk on 1/12/16.
 */


var SearchBox = React.createClass({

    handleSearchSubmit: function(search) {
        var searchs = this.state.data;
        // Optimistically set an id on the new search. It will be replaced by an
        // id generated by the server. In a production application you would likely
        // not use Date.now() for this and would have a more robust system in place.
        search.id = Date.now();
        var newsearchs = searchs.concat([search]);
        this.setState({data: newsearchs});
        console.log(newsearchs);
        console.log(this.props.url);
        $.ajax({
          url: this.props.url,
          dataType: 'json',
          type: 'GET',
          data: search,
          success: function(data) {
            this.setState({data: data});
          }.bind(this),
          error: function(xhr, status, err) {
            this.setState({data: searchs});
            console.error(this.props.url, status, err.toString());
          }.bind(this)
        });
  },

  getInitialState: function() {
    return {data: []};
  },

  render: function() {
    return (
        <div>
            <SearchBanner onSearchSubmit={this.handleSearchSubmit}/>
            <SearchResult />
        </div>
    );
  }

});


var SearchBanner = React.createClass({

    getInitialState: function () {
            return {text: ''};
        },

    handleTextChange: function (e) {
            this.setState({text: e.target.value});
        },

    handleSubmit: function (e) {
        e.preventDefault();
        var text_v = this.state.text.trim();
        if (!text_v) {
            return;
        }
        console.log(text_v);
        console.log({text: text_v});
        this.props.onSearchSubmit({text: text_v});
        this.setState({text: ''});
    },

    render: function() {
        return (
            <div className="search-block-v2">
            <div className="container">
                <div className="col-md-6 col-md-offset-3">
                    <h2>立即搜索</h2>
                     <form onSubmit={this.handleSubmit}>
                        <input
                          type="text"
                          placeholder="java Shanghai"
                          value={this.state.text}
                          onChange={this.handleTextChange}
                        />
                        <input type="submit" value="Search" />
                     </form>
                </div>
            </div>
          </div>
        );
    }

});


var SearchResult = React.createClass({

  render: function() {
    return (
    <div className="container s-results margin-bottom-50">
        <div className="row">
            <div className="col-md-2 hidden-xs related-search">
                <SearchRelated/>
            </div>
            <div className="col-md-10">
                <span className="results-number">共计3345个职位，耗时0.023秒</span>
                <SearchList/>
                <div className="margin-bottom-30"></div>
                <SearchPagination/>
            </div>
        </div>
    </div>
    );
  }

});


var SearchRelated = React.createClass({

  render: function() {
    return (
            <div className="row">
               	<div className="col-md-12 col-sm-4">
                    <h3>Related searches</h3>
                    <ul className="list-unstyled">
                        <li><a href="#">Web design company</a></li>
                        <li><a href="#">Web design tutorials</a></li>
                        <li><a href="#">Self designing</a></li>
                    </ul>
                    <hr/>
                </div>

                <div className="col-md-12 col-sm-4">
                    <h3>Tutorials</h3>
                    <ul className="list-unstyled">
                        <li><a href="#">Basic Concepts</a></li>
                        <li><a href="#">‎Building your first web page</a></li>
                        <li><a href="#">‎Advanced HTML</a></li>
                    </ul>
                    <hr/>
                </div>

                <div className="col-md-12 col-sm-4">
                    <h3>Trending topics</h3>
                    <ul className="list-unstyled">
                        <li><a href="#">Bootstrap</a></li>
                        <li><a href="#">Wrapbootstrap</a></li>
                        <li><a href="#">Codrops</a></li>
                    </ul>
                    <hr/>
                </div>

                <div className="col-md-12 col-sm-4">
                    <h3>Search history</h3>
                    <ul className="list-unstyled">
                        <li><a href="#">Web design articles</a></li>
                        <li><a href="#">Tutorials for web design</a></li>
                    </ul>
                    <a className="see-all" href="#">See all</a>
                    <hr/>
                </div>
                <div className="col-md-12 col-sm-4">
                    <h3>Related pictures</h3>
                    <ul className="list-unstyled blog-photos margin-bottom-30">
                        <li><a href="#"><img src="assets/img/sliders/elastislide/5.jpg" alt="" className="hover-effect"></img></a></li>
                        <li><a href="#"><img src="assets/img/sliders/elastislide/6.jpg" alt="" className="hover-effect"></img></a></li>
                        <li><a href="#"><img src="assets/img/sliders/elastislide/8.jpg" alt="" className="hover-effect"></img></a></li>
                        <li><a href="#"><img src="assets/img/sliders/elastislide/10.jpg" alt="" className="hover-effect"></img></a></li>
                        <li><a href="#"><img src="assets/img/sliders/elastislide/11.jpg" alt="" className="hover-effect"></img></a></li>
                        <li><a href="#"><img src="assets/img/sliders/elastislide/1.jpg" alt="" className="hover-effect"></img></a></li>
                        <li><a href="#"><img src="assets/img/sliders/elastislide/2.jpg" alt="" className="hover-effect"></img></a></li>
                        <li><a href="#"><img src="assets/img/sliders/elastislide/7.jpg" alt="" className="hover-effect"></img></a></li>
                    </ul>
                </div>
            </div>
    );
  }

});


var SearchList = React.createClass({

  render: function() {
    return (
        <div>
            <div className="inner-results">
            <h3><a href="#">Web design</a></h3>
            <ul className="list-inline up-ul">
                <li>en.wikipedia.org/wiki/Web_design‎</li>
                <li className="btn-group">
                    <button data-toggle="dropdown" className="btn btn-default dropdown-toggle" type="button">
                        More<i className="fa fa-caret-down margin-left-5"></i>
                        <span className="sr-only">Toggle Dropdown</span>
                    </button>
                    <ul role="menu" className="dropdown-menu">
                        <li><a href="#">Share</a></li>
                        <li><a href="#">Similar</a></li>
                        <li><a href="#">Advanced search</a></li>
                    </ul>
                </li>
                <li><a href="#">Wrapbootstrap</a></li>
                <li><a href="#">Dribbble</a></li>
            </ul>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum ut orci urna. Morbi blandit enim eget risus posuere dapibus. Vestibulum velit nisi, tempus in placerat non, auctor eu purus. Morbi suscipit porta libero, ac tempus tellus consectetur non. Praesent eget consectetur nunc. Aliquam erat volutpat. Suspendisse ultrices eros eros, consectetur facilisis urna posuere id.</p>
            <ul className="list-inline down-ul">
                <li>
                    <ul className="list-inline star-vote">
                        <li><i className="color-green fa fa-star"></i></li>
                        <li><i className="color-green fa fa-star"></i></li>
                        <li><i className="color-green fa fa-star"></i></li>
                        <li><i className="color-green fa fa-star"></i></li>
                        <li><i className="color-green fa fa-star-half-o"></i></li>
                    </ul>
                </li>
                <li>3 years ago - By Anthon Brandley</li>
                <li>234,034 views</li>
                <li><a href="#">Web designer</a></li>
            </ul>
             <hr/>
         </div>
            <div className="inner-results">
            <h3><a href="#">Web design</a></h3>
            <ul className="list-inline up-ul">
                <li>en.wikipedia.org/wiki/Web_design‎</li>
                <li className="btn-group">
                    <button data-toggle="dropdown" className="btn btn-default dropdown-toggle" type="button">
                        More<i className="fa fa-caret-down margin-left-5"></i>
                        <span className="sr-only">Toggle Dropdown</span>
                    </button>
                    <ul role="menu" className="dropdown-menu">
                        <li><a href="#">Share</a></li>
                        <li><a href="#">Similar</a></li>
                        <li><a href="#">Advanced search</a></li>
                    </ul>
                </li>
                <li><a href="#">Wrapbootstrap</a></li>
                <li><a href="#">Dribbble</a></li>
            </ul>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum ut orci urna. Morbi blandit enim eget risus posuere dapibus. Vestibulum velit nisi, tempus in placerat non, auctor eu purus. Morbi suscipit porta libero, ac tempus tellus consectetur non. Praesent eget consectetur nunc. Aliquam erat volutpat. Suspendisse ultrices eros eros, consectetur facilisis urna posuere id.</p>
            <ul className="list-inline down-ul">
                <li>
                    <ul className="list-inline star-vote">
                        <li><i className="color-green fa fa-star"></i></li>
                        <li><i className="color-green fa fa-star"></i></li>
                        <li><i className="color-green fa fa-star"></i></li>
                        <li><i className="color-green fa fa-star"></i></li>
                        <li><i className="color-green fa fa-star-half-o"></i></li>
                    </ul>
                </li>
                <li>3 years ago - By Anthon Brandley</li>
                <li>234,034 views</li>
                <li><a href="#">Web designer</a></li>
            </ul>
             <hr/>
         </div>
        </div>

    );
  }

});


var SearchItems = React.createClass({

  render: function() {
    return (
      <div className="">

      </div>
    );
  }

});


var SearchPagination = React.createClass({

  render: function() {
    return (
        <div className="text-left">
            <ul className="pagination">
                <li><a href="#">«</a></li>
                <li className="active"><a href="#">1</a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">...</a></li>
                <li><a href="#">157</a></li>
                <li><a href="#">158</a></li>
                <li><a href="#">»</a></li>
            </ul>
        </div>
    );
  }

});

ReactDOM.render(

  <SearchBox url="/api/search" pollInterval={3600000} />,
  document.getElementById('search-box')

);







